# Rime schema
# encoding: utf-8

# === æè¿°æ¡£ ===
schema:
  schema_id: flyyx_rime_jk
  name: çŸ¥å¿ƒå¤§é¹¤
  version: "2024-05-11"
  author:
    - å‘æ˜äºº gaboolic
    - æ’°å†™è€… Jack Liu <loveminimal@163.com>
  description: |
    - çŸ¥å¿ƒå¤§é¹¤ï¼ŒåŒæ‹¼Â·è¾…åŠ©ç ï¼Œå°å•Šå°å¤§é¹¤
    - https://github.com/loveminimal/rime-jk
    - è¾…åŠ©ç æ–¹æ¡ˆæºè‡ª > å¢¨å¥‡è¾…åŠ©ç  é¹¤æ‹¼ç‰ˆ
    - https://github.com/gaboolic/rime-shuangpin-fuzhuma
  dependencies:
    - stroke
  version: 3.0.0                         # ç‰ˆæœ¬å·ï¼Œåœ¨å‘å¸ƒæ–°ç‰ˆå‰è¯·ç¡®ä¿å·²å‡çº§ç‰ˆæœ¬å·
  icon: "assets/fly_m.ico"
  ascii_icon: 'assets/ascii.ico'


# === å¼€å…³ ===
switches:
  - name: ascii_mode                     # ä¸­è‹±æ–‡è½¬æ¢å¼€å…³ï¼Œ0-ä¸­æ–‡  1-è‹±æ–‡
    reset: 0 
    states: [ ä¸­æ–‡, è¥¿æ–‡ ]
  - name: full_shape                     # åŠè§’/å…¨è§’è½¬æ¢ï¼Œ0-åŠè§’ 1-å…¨è§’
    states: [åŠè§’, å…¨è§’]
  - name: emoji
    reset: 1
    states: [ ğŸ’€, ğŸ˜„ ]
  - name: chaifen
    reset: 0 
    states: [ æ‹†éš, æ‹†æ˜¾ ]


# === å¼•æ“ ===
engine:
  # --- å¤„ç†å„ç±»æŒ‰é”®æ¶ˆæ¯ ---
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor

  # --- è¯†åˆ«ä¸åŒå†…å®¹ç±»å‹ï¼Œå°†è¾“å…¥ç åˆ†æ®µå¹¶åŠ ä¸Š tag ---
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor

  # --- ç¿»è¯‘ç‰¹å®šç±»å‹çš„ç¼–ç æ®µä¸ºä¸€ç»„å€™é€‰æ–‡å­— ---
  translators:
    - punct_translator
    - table_translator@custom_phrase             # 1ã€2ç ç½®é¡¶
    - script_translator
    - reverse_lookup_translator
    - lua_translator@*date_translator    # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - lua_translator@*force_gc           # æš´åŠ› GC é™ä½å†…å­˜
    
  # --- è¿‡æ»¤ç¿»è¯‘çš„ç»“æœï¼Œè‡ªå®šä¹‰æ»¤é•œçš†å¯ä½¿ç”¨å¼€å…³è°ƒæ§ ---
  filters:
    # luaçš„filterï¼š
    - lua_filter@*pro_comment_format                #è¶…çº§æ³¨é‡Šæ¨¡å—ï¼Œæ”¯æŒé”™è¯é”™éŸ³æç¤ºã€ä»»æ„é•¿åº¦è¾…åŠ©ç æ˜¾ç¤ºï¼Œæ”¯æŒä¸ªæ€§åŒ–é…ç½®å’Œå…³é—­ç›¸åº”çš„åŠŸèƒ½ï¼Œè¯¦æƒ…æœç´¢pro_comment_formatè¿›è¡Œè¯¦ç»†é…ç½®
    # - lua_filter@*stick       #ç®€ç å›æ˜¾
    # - lua_filter@*is_in_user_dict # ç”¨æˆ·è¯å…¸çš„è¯åŠ ä¸Šä¸€ä¸ª*
    # åæŸ¥çš„filter
    - simplifier                         # ç”¨å­—è½¬æ¢ï¼Œï¼Ÿé»˜è®¤ç¹è½¬ç®€
    - simplifier@emoji                   # Emoji
    - uniquifier
    - simplifier@chaifen



speller:
  max_code_length: 5
  # table_translatorç¿»è¯‘å™¨ï¼Œæ”¯æŒè‡ªåŠ¨ä¸Šå±ã€‚ä¾‹å¦‚ â€œzmhuâ€å¯ä»¥è‡ªåŠ¨ä¸Šå±â€œæ€ä¹ˆå›äº‹â€
  auto_select: false
  auto_select_pattern: ^[a-z]+/|^[a-df-zA-DF-Z]\w{3}|^e\w{4}|;[a-z]
  # å¦‚æœä¸æƒ³è®©ä»€ä¹ˆæ ‡ç‚¹ç›´æ¥ä¸Šå±ï¼Œå¯ä»¥åŠ åœ¨ alphabetï¼Œæˆ–è€…ç¼–è¾‘æ ‡ç‚¹ç¬¦å·ä¸ºä¸¤ä¸ªåŠä»¥ä¸Šçš„æ˜ å°„
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA[/|
  # initials å®šä¹‰ä»…ä½œä¸ºå§‹ç çš„æŒ‰é”®ï¼Œæ’é™¤ ` è®©å•ä¸ªçš„ ` å¯ä»¥ç›´æ¥ä¸Šå±
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
  # ç¬¬ä¸€ä½<ç©ºæ ¼>æ˜¯æ‹¼éŸ³ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼›ç¬¬äºŒä½<'>è¡¨ç¤ºå¯ä»¥æ‰‹åŠ¨è¾“å…¥å•å¼•å·æ¥åˆ†å‰²æ‹¼éŸ³ã€‚
  delimiter: " '"
  ## speller æœªå…è®¸ aj è¡¨ç¤º an
  algebra:
    # è¿™ä¸€æ®µæ˜¯ä¸ºäº†æ”¯æŒåŠ è½½å…¨æ‹¼è¯åº“
    # - xform/^([aoe])$/$1$1/
    # - xform/^(ang)$/ah/
    # - xform/^([^\[]*)iu$/$1Q/
    # - xform/^([^\[]*)ei$/$1W/
    # - xform/uan$/R/
    # - xform/^([^\[]*)[uv]e$/$1T/
    # - xform/^([^\[]*)un$/$1Y/
    # - xform/^sh([^\[]+)/U$1/
    # - xform/^ch([^\[]+)/I$1/
    # - xform/^zh([^\[]+)/V$1/
    # - xform/^([^\[]*)uo$/$1O/
    # - xform/^([^\[]*)ie$/$1P/
    # - xform/i?ong$/S/
    # - xform/ing$|uai$/K/
    # - xform/^([^\[]+)ai$/$1D/
    # - xform/^([^\[]+)en$/$1F/
    # - xform/^([^\[]+)eng$/$1G/
    # - xform/[iu]ang$/L/
    # - xform/(.)ang$/$1H/
    # - xform/^([^\[]*)ian$/$1M/
    # - xform/^([^\[]+)an$/$1J/
    # - xform/^([^\[]+)ou$/$1Z/
    # - xform/^([^\[]*)[iu]a$/$1X/
    # - xform/^([^\[]*)iao$/$1N/
    # - xform/^([^\[]+)ao$/$1C/
    # - xform/^([^\[]*)ui$/$1V/
    # - xform/^([^\[]*)in$/$1B/
    # - xlit/QWRTYUIOPSDFGHJKLZXCVBNM/qwrtyuiopsdfghjklzxcvbnm/

    # æ¨¡ç³ŠéŸ³ å¯é€‰æ‹©æ€§å¼€å¯
    # - derive/^z([a-z])/v$1/
    # - derive/^c([a-z])/i$1/
    # - derive/^s([a-z])/u$1/
    # - derive/^v([a-z])/z$1/
    # - derive/^i([a-z])/c$1/
    # - derive/^u([a-z])/s$1/

    # - derive/^([jqxy])u/$1v/ # å¼€å¯jv=juçš„æ¨¡å¼

    - derive|^(.+)[[](\w)(\w)$|$1|       # çº¯åŒæ‹¼çš„æƒ…å†µ
    - derive|^(.+)[[](\w)(\w)$|$1$2|     # åŒæ‹¼+ä¸€ä½è¾…åŠ©ç çš„æƒ…å†µ
    - derive|^(.+)[[](\w)(\w)$|$1[$2|    # åŒæ‹¼+[ä¸€ä½è¾…åŠ©ç çš„æƒ…å†µ
    - abbrev|^(.+)[[](\w)(\w)$|$1$2$3|   # åŒæ‹¼+2ä½è¾…åŠ©ç çš„æƒ…å†µï¼Œabbrevç±»å‹ä¸å¯ä»¥æ•´å¥å†…è¾“å…¥2ä½è¾…åŠ©ç ï¼Œå¿…é¡»åŠ oæˆ–/
    - derive|^(.+)[[](\w)(\w)$|$1$2$3o|  # æ•´å¥æ¨¡å¼ä¸‹ï¼Œè¾“å…¥syffo å‡ºå•å­— å¢å¼ºå•å­—æ€§èƒ½
    - derive|^(.+)[[](\w)(\w)$|$1$2$3/|  # æ•´å¥æ¨¡å¼ä¸‹ï¼Œè¾“å…¥syff/ å‡ºå•å­— å¢å¼ºå•å­—æ€§èƒ½
    # - derive/[[]// ## å–æ¶ˆæ³¨é‡Šåï¼šç›´æ¥å¼•å¯¼2ä½è¾…åŠ©ç ï¼›å¦åˆ™åªèƒ½å¼•å¯¼1ä½è¾…åŠ©ç æˆ–è€…2ä½è¾…åŠ©ç åŠ /

    ## é£é”® å¯é€‰æ‹©æ€§å¼€å¯
    - derive/^([y])j/$1f/
    - derive/^qx/qw/
    - derive/^xq/xo/
    - derive/^qq/qo/
    - derive/^ww/wi/
    # - derive/^y([a-df-qs-z])/e$1/ # y -> eäº’å‡»
    - derive/^j([a-twyz])/f$1/ # j -> fäº’å‡»
    # - derive/^jn/jv/
    # - derive/^mn/mv/
    # - derive/^jm/jz/
    - derive/^([y])h/$1g/
    # - derive/^([rgv])f/$1m/
    - derive/^([rsgv])c/$1n/

# === segmentor ===
abc_segmentor:
  extra_tags:                            # ä¸ºæ­¤ segmentor æ‰€æ ‡è®°çš„æ®µè½æ’ä¸Šå…¶å®ƒ tag
    - reverse_lookup

translator:
  dictionary: flyyx_rime_jk
  # initial_quality: 10000
  # æ˜¯å¦è‡ªåŠ¨è¡¥å…¨ï¼ˆé¢„æµ‹ï¼‰ï¼Œé…Œæƒ…å¼€å¯ã€‚å¼€å¯ä¹‹åï¼Œæ‰“ilqmmkytçš„æ—¶å€™ï¼Œ2é€‰ä¼šæ˜¯"åºŠå‰æ˜æœˆå…‰"ã€‚ä½†æ˜¯å½±å“3ç ç®€ç ï¼Œä¾‹å¦‚idzé¦–é€‰ä¼šå˜æˆ"æ‹†å­—"è€Œé"æ‰¯çŠŠå­"
  enable_completion: false
  ##  é»˜è®¤ä¸ºä¸è¶…è¿‡ 2 ä¸ªå­—çš„å€™é€‰é¡¹æ˜¾ç¤ºè¾“å…¥ç ï¼›å°† 2 æ”¹ä¸º 0 å¯å…³é—­ç¼–ç æç¤ºï¼Œ
  ##  æ”¹ä¸º 1 åˆ™æ˜¯åªæ˜¾ç¤ºå•å­—çš„è¾“å…¥ç ï¼Œä¾æ­¤ç±»æ¨ã€‚
  spelling_hints: 1
  # enable_sentence: true                  # æ˜¯å¦å¼€å¯è‡ªåŠ¨é€ å¥
  enable_user_dict: true                 # æ˜¯å¦å¼€å¯ç”¨æˆ·è¯å…¸ï¼ˆç”¨æˆ·è¯å…¸è®°å½•åŠ¨æ€å­—è¯é¢‘ã€ç”¨æˆ·è¯ï¼‰
  # enable_encoder: true                   # æ˜¯å¦å¼€å¯è‡ªåŠ¨é€ è¯
  comment_format:
    - "xform/(^|[ '])[^[]+[[]/$1/"       # ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†
  preedit_format:
    # å¤åˆ¶ç”¨æˆ·è¾“å…¥, ä¸€ä»½è½¬å¤§å†™ä¿æŒåŸæ ·, ä¸€ä»½ç”±æ­£åˆ™è½¬ä¸ºå…¨æ‹¼æ˜¾ç¤º
    # - xform/(^.*$)/\U$1\E\t => $1 <=/
    # # å°é¹¤åŒæ‹¼è½¬å…¨æ‹¼, å¿½ç•¥è¾…ç 
    # - xform/([ '][aoe])(\w)\w{0,2}/$1$2/
    # - xform/([ ']\w)([aeiou])\w{0,2}/$1$2/
    # - xform/([ '][bpmfdtnljqx])n\w{0,2}/$1iao/
    # - xform/([ ']\w)g\w{0,2}/$1eng/
    # - xform/([ ']\w)q\w{0,2}/$1iu/
    # - xform/([ ']\w)w\w{0,2}/$1ei/
    # - xform/([ '][dtnlgkhjqxyvuirzcs])r\w{0,2}/$1uan/
    # - xform/([ ']\w)t\w{0,2}/$1ve/
    # - xform/([ ']\w)y\w{0,2}/$1un/
    # - xform/([ '][dtnlgkhvuirzcs])o\w{0,2}/$1uo/
    # - xform/([ ']\w)p\w{0,2}/$1ie/
    # - xform/([ '][jqx])s\w{0,2}/$1iong/
    # - xform/([ ']\w)s\w{0,2}/$1ong/
    # - xform/([ ']\w)d\w{0,2}/$1ai/
    # - xform/([ ']\w)f\w{0,2}/$1en/
    # - xform/([ ']\w)h\w{0,2}/$1ang/
    # - xform/([ ']\w)j\w{0,2}/$1an/
    # - xform/([ '][gkhvuirzcs])k\w{0,2}/$1uai/
    # - xform/([ ']\w)k\w{0,2}/$1ing/
    # - xform/([ '][jqxnl])l\w{0,2}/$1iang/
    # - xform/([ ']\w)l\w{0,2}/$1uang/
    # - xform/([ ']\w)z\w{0,2}/$1ou/
    # - xform/([ '][gkhvuirzcs])x\w{0,2}/$1ua/
    # - xform/([ ']\w)x\w{0,2}/$1ia/
    # - xform/([ ']\w)c\w{0,2}/$1ao/
    # - xform/([ '][dtgkhvuirzcs])v\w{0,2}/$1ui/
    # - xform/([ ']\w)b\w{0,2}/$1in/
    # - xform/([ ']\w)m\w{0,2}/$1ian/
    # - "xform/(^|[ '])v/$1zh/"
    # - "xform/(^|[ '])i/$1ch/"
    # - "xform/(^|[ '])u/$1sh/"
    # - xform/([ '][jqxy])v\w{0,2}/$1u/
    # - xform/([ '][nl])v\w{0,2}/$1Ã¼/
    # # åŒæ‹¼ç¼–ç å¤§å†™è½¬å›å°å†™
    # - xform/(^[^a-z=<>]*)/\L$1\E/
    # - xform/=> */[/
    # - xform/ *<=/]/

# === Lua é…ç½®: æ—¥æœŸæ—¶é—´(æ•´åˆç‰ˆ)çš„è§¦å‘å…³é”®å­— ===
date_translator:
  jk_datetime: iii

reverse_lookup:
  dictionary: stroke
  enable_completion: true
  prefix: "`"
  suffix: "'"
  tips: ã€”ç¬”ç”»ã€•
  preedit_format:
    - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/
  comment_format:
    - xform/([nl])v/$1Ã¼/

# === è‡ªå®šä¹‰çŸ­è¯­ï¼šcustom_phrase.txt ===
custom_phrase:
  dictionary: ""
  user_dict: custom_phrase               # å¯ä»¥ä¿®æ”¹è¿™é‡Œï¼Œæ”¹æˆè‡ªå·±çš„ txt æ–‡ä»¶
  db_class: stabledb                     # åªè¯»æ•°æ®åº“ï¼Œæ— æ³•åŠ¨æ€è°ƒé¢‘ï¼›è®¾ä¸º tabledb å¯ä»¥åŠ¨æ€è°ƒé¢‘
  enable_completion: false               # è¡¥å…¨æç¤º
  enable_sentence: false                 # ç¦æ­¢é€ å¥
  initial_quality: 99                    # custom_phrase çš„æƒé‡åº”è¯¥æ¯” pinyin å’Œ melt_eng å¤§


# === Emoji ===
emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false                 # åœ¨ corrector.lua åŠåæŸ¥ä¸­ï¼Œemoji è¿”å›ç©ºæ³¨é‡Š

# === æ ‡ç‚¹ç¬¦å·æ§åˆ¶ ===
punctuator:
  import_preset: default                 # è®¾å®šç¬¦å·è¡¨ï¼Œè¿™é‡Œç›´æ¥å¯¼å…¥é¢„è®¾çš„


# === é”®ä½ç»‘å®š ===
key_binder:
  import_preset: default
  # è¿ç§»è‡³ default.custom.yaml ï¼Œä»¥æ–¹ä¾¿å¤šæ–¹æ¡ˆå…±äº«


# === ä¸‹è®¾ patterns ï¼Œé…åˆ segmentor çš„ prefix å’Œ suffix å®Œæˆæ®µè½åˆ’åˆ†ã€tag åˆ†é… ===
recognizer:
  patterns:
    import_preset: default
    reverse_lookup: "`[a-z]*'?$"
