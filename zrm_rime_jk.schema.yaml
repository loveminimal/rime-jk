# Rime schema
# encoding: utf-8

# === åˆå§‹åŒ– ===
set_shuru_schema:                         # é…ç½®è¾“å…¥æ–¹æ¡ˆ
  __include: wanxiang.yaml:/algebra_zrm   # å¯é€‰è§£ç è§„åˆ™æœ‰ï¼š algebra_py, algebra_zrm, algebra_flypy
set_algebra_fuzhu:                        # é…ç½®æ­¤é¡¹å°±æ˜¯é€‰æ‹©ä»€ä¹ˆè¾…åŠ©ç 
  __include: wanxiang.yaml:/fuzhu_moqi    # å¯é€‰è¾…åŠ©ç æœ‰ï¼šfuzhu_kongï¼Œfuzhu_moqi, fuzhu_zrm, fuzhu_flypy, fuzhu_tiger, fuzhu_wubi, fuzhu_hanxin
pro_comment_format:
  __include: wanxiang.yaml:/pro_comment_format 
  fuzhu_type: moqi


# === æè¿°æ¡£ ===
schema:
  schema_id: zrm_rime_jk
  name: çŸ¥å¿ƒè‡ªç„¶
  author:
    - å‘æ˜äºº gaboolic
    - æ’°å†™è€… Jack Liu <loveminimal@163.com>
  description: |
    - çŸ¥å¿ƒè‡ªç„¶ï¼ŒåŒæ‹¼Â·è¾…åŠ©ç ï¼Œå°å•Šå°è‡ªç„¶
    - https://github.com/loveminimal/rime-jk
    - è¾…åŠ©ç æ–¹æ¡ˆæºè‡ªä¸‡è±¡æ‹¼éŸ³ https://github.com/amzxyz/rime_wanxiang_pro
  dependencies:
    - pinyin_simp
  version: 3.0.0                         # ç‰ˆæœ¬å·ï¼Œåœ¨å‘å¸ƒæ–°ç‰ˆå‰è¯·ç¡®ä¿å·²å‡çº§ç‰ˆæœ¬å·
  icon: "assets/bi_e.ico"
  ascii_icon: 'assets/ascii.ico'


# === å¼€å…³ ===
switches:
  - name: ascii_mode                     # ä¸­è‹±æ–‡è½¬æ¢å¼€å…³ï¼Œ0-ä¸­æ–‡  1-è‹±æ–‡
    reset: 0 
    states: [ ä¸­æ–‡, è¥¿æ–‡ ]
  - name: full_shape                     # åŠè§’/å…¨è§’è½¬æ¢ï¼Œ0-åŠè§’ 1-å…¨è§’
    states: [åŠè§’, å…¨è§’]
  - name: emoji
    reset: 1
    states: [ ğŸ’€, ğŸ˜„ ]
  - name: chaifen
    reset: 0
    states: [ æ‹†éš, æ‹†æ˜¾ ]


# === å¼•æ“ ===
engine:
  # --- å¤„ç†å„ç±»æŒ‰é”®æ¶ˆæ¯ ---
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor

  # --- è¯†åˆ«ä¸åŒå†…å®¹ç±»å‹ï¼Œå°†è¾“å…¥ç åˆ†æ®µå¹¶åŠ ä¸Š tag ---
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor

  # --- ç¿»è¯‘ç‰¹å®šç±»å‹çš„ç¼–ç æ®µä¸ºä¸€ç»„å€™é€‰æ–‡å­— ---
  translators:
    - punct_translator
    - table_translator@custom_phrase     # 1ã€2ç ç½®é¡¶
    - script_translator
    - reverse_lookup_translator
    - lua_translator@*date_translator    # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - lua_translator@*force_gc           # æš´åŠ› GC é™ä½å†…å­˜
    
  # --- è¿‡æ»¤ç¿»è¯‘çš„ç»“æœï¼Œè‡ªå®šä¹‰æ»¤é•œçš†å¯ä½¿ç”¨å¼€å…³è°ƒæ§ ---
  filters:
    # luaçš„filterï¼š
    - lua_filter@*pro_comment_format     # è¶…çº§æ³¨é‡Šæ¨¡å—
    - lua_filter@*is_in_user_dict        # ç”¨æˆ·è¯å…¸çš„è¯åŠ ä¸Šä¸€ä¸ª*
    # åæŸ¥çš„filter
    - simplifier                         # ç”¨å­—è½¬æ¢ï¼Œï¼Ÿé»˜è®¤ç¹è½¬ç®€
    - simplifier@emoji                   # Emoji
    - uniquifier
    - simplifier@chaifen


# === speller ===
speller:
  max_code_length: 5
  # table_translatorç¿»è¯‘å™¨ï¼Œæ”¯æŒè‡ªåŠ¨ä¸Šå±ã€‚ä¾‹å¦‚ â€œzmhuâ€å¯ä»¥è‡ªåŠ¨ä¸Šå±â€œæ€ä¹ˆå›äº‹â€
  auto_select: false
  auto_select_pattern: ^[a-z]+/|^[a-df-zA-DF-Z]\w{3}|^e\w{4}|;[a-z]
  # å¦‚æœä¸æƒ³è®©ä»€ä¹ˆæ ‡ç‚¹ç›´æ¥ä¸Šå±ï¼Œå¯ä»¥åŠ åœ¨ alphabetï¼Œæˆ–è€…ç¼–è¾‘æ ‡ç‚¹ç¬¦å·ä¸ºä¸¤ä¸ªåŠä»¥ä¸Šçš„æ˜ å°„
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA[/|
  # initials å®šä¹‰ä»…ä½œä¸ºå§‹ç çš„æŒ‰é”®ï¼Œæ’é™¤ ` è®©å•ä¸ªçš„ ` å¯ä»¥ç›´æ¥ä¸Šå±
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
  # ç¬¬ä¸€ä½<ç©ºæ ¼>æ˜¯æ‹¼éŸ³ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼›ç¬¬äºŒä½<'>è¡¨ç¤ºå¯ä»¥æ‰‹åŠ¨è¾“å…¥å•å¼•å·æ¥åˆ†å‰²æ‹¼éŸ³ã€‚
  delimiter: " '"
  # speller æœªå…è®¸ aj è¡¨ç¤º an
  algebra:
    __patch:
      - set_shuru_schema                 #æ‹¼éŸ³è½¬åŒæ‹¼ç 
      - set_algebra_fuzhu                #è¾…åŠ©ç éƒ¨åˆ†

    # --- é£é”® å¯é€‰æ‹©æ€§å¼€å¯ ---
    # - derive/^([y])j/$1f/
    # - derive/^qx/qw/
    # - derive/^xq/xo/
    # - derive/^qq/qo/
    # - derive/^ww/wi/
    # # - derive/^y([a-df-qs-z])/e$1/ # y -> eäº’å‡»
    # - derive/^j([a-twyz])/f$1/ # j -> fäº’å‡»
    # # - derive/^jn/jv/
    # # - derive/^mn/mv/
    # # - derive/^jm/jz/
    # - derive/^([y])h/$1g/
    # # - derive/^([rgv])f/$1m/
    # - derive/^([rsgv])c/$1n/

# === segmentor ===
abc_segmentor:
  extra_tags:                            # ä¸ºæ­¤ segmentor æ‰€æ ‡è®°çš„æ®µè½æ’ä¸Šå…¶å®ƒ tag
    - reverse_lookup

translator:
  dictionary: wanxiang
  prism: zrm_rime_jk                     # prism è¦ä»¥æœ¬è¾“å…¥æ–¹æ¡ˆçš„åç§°æ¥å‘½åï¼Œä»¥å…æŠŠ wubi86 çš„æ‹¼å†™æ˜ å°„è¦†ç›–æ‰
  # initial_quality: 10000
  # æ˜¯å¦è‡ªåŠ¨è¡¥å…¨ï¼ˆé¢„æµ‹ï¼‰ï¼Œé…Œæƒ…å¼€å¯ã€‚
  # ... å¼€å¯ä¹‹åï¼Œæ‰“ ilqmmkyt çš„æ—¶å€™ï¼ŒäºŒé€‰ä¼šæ˜¯"åºŠå‰æ˜æœˆå…‰",
  # ... ä½†æ˜¯å½±å“3ç ç®€ç ï¼Œä¾‹å¦‚ idz é¦–é€‰ä¼šå˜æˆ"æ‹†å­—"è€Œé"æ‰¯çŠŠå­"
  enable_completion: false
  # é»˜è®¤ä¸ºä¸è¶…è¿‡ 2 ä¸ªå­—çš„å€™é€‰é¡¹æ˜¾ç¤ºè¾“å…¥ç ï¼›
  # ... å°† 2 æ”¹ä¸º 0 å¯å…³é—­ç¼–ç æç¤ºï¼Œ
  # ... æ”¹ä¸º 1 åˆ™æ˜¯åªæ˜¾ç¤ºå•å­—çš„è¾“å…¥ç ï¼Œä¾æ­¤ç±»æ¨
  spelling_hints: 1
  # enable_sentence: true                # æ˜¯å¦å¼€å¯è‡ªåŠ¨é€ å¥
  enable_user_dict: true                 # æ˜¯å¦å¼€å¯ç”¨æˆ·è¯å…¸ï¼ˆç”¨æˆ·è¯å…¸è®°å½•åŠ¨æ€å­—è¯é¢‘ã€ç”¨æˆ·è¯ï¼‰
  enable_encoder: true                   # æ˜¯å¦å¼€å¯è‡ªåŠ¨é€ è¯
  comment_format: {comment}              # å°†æ³¨é‡Šä»¥è¯å…¸å­—ç¬¦ä¸²å½¢å¼å®Œå…¨æš´éœ²ï¼Œé€šè¿‡pro_comment_format.luaå®Œå…¨æ¥ç®¡ï¼Œçµæ´»é…ç½®
  # comment_format:
    # - xform/(^|[ '])[^[]+[[]/$1/       # ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†
    # - xform/(\w\w)[[](\w\w)/$1-$2/
    # - xform/(\w\w)[[](\w\w)/$2/
    # - xform/(\w\w)\[(\w\w)/$1-$2/
  # preedit_format:                      # å°†å…¶ç›´æ¥ä¿®æ”¹ä¸º comment_format ï¼Œå°±å¯ä»¥è¾“ä»€ä¹ˆæ˜¾ç¤ºä»€ä¹ˆ
  # # comment_format:
  #   - xform/([bpmfdtnljqx])n/$1iao/
  #   - xform/(\w)g/$1eng/
  #   - xform/(\w)q/$1iu/
  #   - xform/(\w)w/$1ei/
  #   - xform/([dtnlgkhjqxyvuirzcs])r/$1uan/
  #   - xform/(\w)t/$1ve/
  #   - xform/(\w)y/$1un/
  #   - xform/([dtnlgkhvuirzcs])o/$1uo/
  #   - xform/(\w)p/$1ie/
  #   - xform/([jqx])s/$1iong/
  #   - xform/(\w)s/$1ong/
  #   - xform/(\w)d/$1ai/
  #   - xform/(\w)f/$1en/
  #   - xform/(\w)h/$1ang/
  #   - xform/(\w)j/$1an/
  #   - xform/([gkhvuirzcs])k/$1uai/
  #   - xform/(\w)k/$1ing/
  #   - xform/([jqxnl])l/$1iang/
  #   - xform/(\w)l/$1uang/
  #   - xform/(\w)z/$1ou/
  #   - xform/([gkhvuirzcs])x/$1ua/
  #   - xform/(\w)x/$1ia/
  #   - xform/(\w)c/$1ao/
  #   - xform/([dtgkhvuirzcs])v/$1ui/
  #   - xform/(\w)b/$1in/
  #   - xform/(\w)m/$1ian/
  #   - xform/([aoe])\1(\w)/$1$2/
  #   - "xform/(^|[ '])v/$1zh/"
  #   - "xform/(^|[ '])i/$1ch/"
  #   - "xform/(^|[ '])u/$1sh/"
  #   - xform/([jqxy])v/$1u/
  #   - xform/([nl])v/$1Ã¼/

# === Lua é…ç½®: æ—¥æœŸæ—¶é—´(æ•´åˆç‰ˆ)çš„è§¦å‘å…³é”®å­— ===
date_translator:
  jk_datetime: iii


reverse_lookup:
  dictionary: pinyin_simp
  prefix: "`"
  suffix: "'"
  tips: ã€”æ‹¼éŸ³ã€•
  preedit_format:
    - xform/([nl])v/$1Ã¼/
    - xform/([nl])ue/$1Ã¼e/
    - xform/([jqxy])v/$1u/


# === è‡ªå®šä¹‰çŸ­è¯­ï¼šcustom_phrase.txt ===
custom_phrase:
  dictionary: ""
  user_dict: custom_phrase               # å¯ä»¥ä¿®æ”¹è¿™é‡Œï¼Œæ”¹æˆè‡ªå·±çš„ txt æ–‡ä»¶
  db_class: stabledb                     # åªè¯»æ•°æ®åº“ï¼Œæ— æ³•åŠ¨æ€è°ƒé¢‘ï¼›è®¾ä¸º tabledb å¯ä»¥åŠ¨æ€è°ƒé¢‘
  enable_completion: false               # è¡¥å…¨æç¤º
  enable_sentence: false                 # ç¦æ­¢é€ å¥
  initial_quality: 99                    # custom_phrase çš„æƒé‡åº”è¯¥æ¯” pinyin å’Œ melt_eng å¤§


# === Emoji ===
emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false                 # åœ¨ corrector.lua åŠåæŸ¥ä¸­ï¼Œemoji è¿”å›ç©ºæ³¨é‡Š


# æ˜¾ç¤ºå¢¨å¥‡ç æ‹†åˆ†
chaifen:
  option_name: chaifen
  opencc_config: zrm_cf.json
  tips: char
  show_in_comment: true
  comment_format:
    - "xform/	/ /"


# === æ ‡ç‚¹ç¬¦å·æ§åˆ¶ ===
punctuator:
  import_preset: default                 # è®¾å®šç¬¦å·è¡¨ï¼Œè¿™é‡Œç›´æ¥å¯¼å…¥é¢„è®¾çš„


# === é”®ä½ç»‘å®š ===
key_binder:
  import_preset: default
  # è¿ç§»è‡³ default.custom.yaml ï¼Œä»¥æ–¹ä¾¿å¤šæ–¹æ¡ˆå…±äº«


# === ä¸‹è®¾ patterns ï¼Œé…åˆ segmentor çš„ prefix å’Œ suffix å®Œæˆæ®µè½åˆ’åˆ†ã€tag åˆ†é… ===
recognizer:
  patterns:
    import_preset: default
    reverse_lookup: "`[a-z]*'?$"


